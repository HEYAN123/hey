<!DOCTYPE html>
<html {{ htmlAttributes | safe }}>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hey Design</title>
    <link
      rel="shortcut icon"
      href="https://hey-design.oss-cn-beijing.aliyuncs.com/icon.png"
      type="image/x-icon"
    />
    {% for cssFile in manifest["css"] %}
    <!-- gitpages -->
    <link rel="stylesheet" type="text/css" href="{{ root }}hey/{{ cssFile }}" />
    <!-- <link rel="stylesheet" type="text/css" href="{{ root }}{{ cssFile }}" /> -->
    {% endfor %}
    <style id="nprogress-style">
      #nprogress {
        display: none;
      }
    </style>
    <!-- gitpages -->
    <link rel="stylesheet/less" type="text/css" href="{{ root }}hey/color.less" />
    <!-- <link rel="stylesheet/less" type="text/css" href="{{ root }}color.less" /> -->
    <script src="https://polyfill.alicdn.com/polyfill.min.js?features=default,es2015,Intl"></script>
    <script>
      (function() {
        function isLocalStorageNameSupported() {
          var testKey = 'test';
          var storage = window.localStorage;
          try {
            storage.setItem(testKey, '1');
            storage.removeItem(testKey);
            return true;
          } catch (error) {
            return false;
          }
        }
        // 判断当前访问的路径
        var pathname = location.pathname;
        // 判断是否中文：是否有-cn后缀
        function isZhCN(pathname) {
          return /-cn\/?$/.test(pathname);
        }
        // 获取当地对应的语言路由
        function getLocalizedPathname(path, zhCN) {
          console.log(path);
          // 路由是不是以“/”开始的，如果是就取path本身，否则取/+path
          var pathname = path.startsWith('/') ? path : '/' + path;
          if (pathname === '/hey/' || pathname === '/') {
            return 'hey/index-cn';
          } else if (pathname.endsWith('/')) {
            return pathname.replace(/\/$/, '-cn/');
          }
          return pathname + '-cn';
        }

        // 如果访问首页
        if (isLocalStorageNameSupported() && (pathname === '/hey/' || pathname === '/hey/index-cn')) {
          var lang = 'zh-CN';
          // safari is 'zh-cn', while other browser is 'zh-CN';
          if (!isZhCN(pathname)) {
            location.pathname = getLocalizedPathname(pathname, lang === 'zh-CN');
          }
        }
        document.documentElement.className += 'zh-cn';
      })();
    </script>
  </head>
  <body>
    <div id="react-content">
      {{ content | safe }}
    </div>
    {% for jsFile in manifest["js"] %}
    <!-- gitpages -->
    <script src="{{ root }}hey/{{ jsFile }}"></script>
    <!-- <script src="{{ root }}{{ jsFile }}"></script> -->
    {% endfor %}
  </body>
</html>
